{% extends "index.html" %}

{% block maincontent %}
{% load dictionary_helpers %}
<div id="react-search-results" class="row"></div>
{% block footer %}
<ul class="pager">
  {% if data.videos.prevPageToken %}
  <li class="previous"><a href="/?query={{data.query}}&pageToken={{data.videos.prevPageToken}}">&larr; Previous</a></li>
  {% else %}
  <li class="previous disabled"><a>&larr; Previous</a></li>
  {% endif %} 
  {% if data.videos.nextPageToken %}
  <li class="next"><a href="/?query={{data.query}}&pageToken={{data.videos.nextPageToken}}">Next &rarr;</a></li>
  {% else %}
  <li class="next disabled"><a>Next &rarr;</a></li>
  {% endif %}
</ul>
{% endblock footer %}
{% endblock maincontent %}

{% block js %}
<script src="/static/js/build/SearchResultForm.js"></script>
<script src="/static/js/build/SearchResult.js"></script>
<script src="/static/js/build/SearchResultContainer.js"></script>
<script>
  React.renderComponent(
    SearchResultContainer({data:{{data|safe}}, csrftoken:"{{csrf_token}}"}),
    document.getElementById('react-search-results')
  );
  var csrftoken = $.cookie('csrftoken');
  function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
  }
  $.ajaxSetup({
    crossDomain: false,
    beforeSend: function(xhr, settings) {
      if (!csrfSafeMethod(settings.type)) {
        xhr.setRequestHeader("X-CSRFToken", csrftoken);
      }
    }
  });
  $("#form-container").on('submit', function(e) {
    var values = {};
    var postURL = "";
    var $button = $("input[type=submit][clicked=true]");
    if ($button.hasClass("add-song")) {
      postURL = "add-song-data/";
    } else if ($button.hasClass("add-group")) {
      postURL = "add-group-data/";
    }
    console.log(postURL);
    console.log($button);
    $.each($(this).serializeArray(), function(i, field) {
      values[field.name] = field.value;
    });
    console.log(values);
    console.log(e);
    /*$.post(
      postURL,
      values,
      function() {
        console.log("success");
      }
    );*/
    return false;
  });
</script>
{% endblock js %}
